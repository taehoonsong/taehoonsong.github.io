<!doctype html>
<html  dir="ltr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Central Limit Theorem</title>

        <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/uikit/2.26.4/css/uikit.gradient.css"
    />
    
    <!-- Icons -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon-precomposed" href="/img/apple-touch-icon.png" />
    <link rel="icon" size="32x32" href="/img/favicon-32x32.png" />
    <link rel="icon" size="16x16" href="/img/favicon-16x16.png" />

    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"
    ></script>
    <!-- <link rel="stylesheet" href="style.css"> -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/diversen/pandoc-uikit@master/style.css"
    />
    <link rel="stylesheet" href="/css/posts.css" />
    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script src="uikit.js"></script> -->
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-uikit@master/uikit.js"></script>
    <!-- <script src="scripts.js"></script> -->
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-uikit@master/scripts.js"></script>
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-uikit@master/jquery.sticky-kit.js"></script>

    <meta name="generator" content="pandoc-uikit" />
         <meta name="date" content="2021-05-17" />
        <title>Central Limit Theorem</title>
    <style type="text/css">
      code {
        white-space: pre;
      }
    </style>
         <style type="text/css">
      html { -webkit-text-size-adjust: 100%; }
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ff0000; font-weight: bold; } /* Alert */
      code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #7d9029; } /* Attribute */
      code span.bn { color: #40a070; } /* BaseN */
      code span.bu { color: #008000; } /* BuiltIn */
      code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4070a0; } /* Char */
      code span.cn { color: #880000; } /* Constant */
      code span.co { color: #60a0b0; font-style: italic; } /* Comment */
      code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #ba2121; font-style: italic; } /* Documentation */
      code span.dt { color: #902000; } /* DataType */
      code span.dv { color: #40a070; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #40a070; } /* Float */
      code span.fu { color: #06287e; } /* Function */
      code span.im { color: #008000; font-weight: bold; } /* Import */
      code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #007020; font-weight: bold; } /* Keyword */
      code span.op { color: #666666; } /* Operator */
      code span.ot { color: #007020; } /* Other */
      code span.pp { color: #bc7a00; } /* Preprocessor */
      code span.sc { color: #4070a0; } /* SpecialChar */
      code span.ss { color: #bb6688; } /* SpecialString */
      code span.st { color: #4070a0; } /* String */
      code span.va { color: #19177c; } /* Variable */
      code span.vs { color: #4070a0; } /* VerbatimString */
      code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
       
  </head>

  <body>
        <header class="page-header">
      <div class="container">
        <div class="header-top flex-responsive">
          <h1 class="header-info">Central Limit Theorem</h1>
          <br />
                    <h2 class="header-label">2021-05-17</h2>
                     <p class="header-summary">Anyone who has taken an
introductory statistics course probably learned about the Central Limit
Theorem (CLT). During my time as a Teaching Assistant at George Mason
University, I noticed that students don’t quite understand what CLT is
or why CLT is important. Hopefully, this post can serve as another
reference for those who are struggling to understand this core
statistical concept.</p>
                  </div>
      </div>
    </header>
    
    <div
      class="uk-container uk-container-center uk-margin-top uk-margin-large-bottom"
    >
      <div class="uk-grid" data-uk-grid-margin>
        <div class="uk-width-medium-1-4">
          <div
            class="uk-overflow-container"
            data-uk-sticky="{top:25,media: 768}"
          >
                        <div class="uk-panel uk-panel-box menu-begin">
              <ul>
              <li><a href="#misunderstanding"
              id="toc-misunderstanding">Misunderstanding</a></li>
              <li><a href="#sampling-distribution"
              id="toc-sampling-distribution">Sampling
              distribution</a></li>
              <li><a href="#importance-of-clt"
              id="toc-importance-of-clt">Importance of CLT</a></li>
              </ul>
            </div>
                      </div>
        </div>

        <div class="uk-width-medium-3-4">
           <h1 id="misunderstanding">Misunderstanding</h1>
<p>The biggest and most common mistake I saw students make is
misunderstanding that CLT is some magic theory that makes every
distribution a Normal distribution given a large enough sample size. I
want to get this out of the way as early as possible: <strong>No, the
CLT doesn’t turn any distribution into a Normal distribution simply
because the sample size is large</strong>. This misunderstanding isn’t
limited to statistics students. I’ve seen websites and “professionals”
make this exact mistake. Below is the first paragraph on Investopedia
regarding CLT:</p>
<blockquote>
<p>In the study of probability theory, the central limit theorem (CLT)
states that the <a
href="https://www.investopedia.com/terms/s/sampling-distribution.asp">distribution
of sample</a> approximates a Normal distribution (also known as a "bell
curve") as the sample size becomes larger, assuming that all samples are
identical in size, and regardless of the population distribution
shape.</p>
<p><a
href="https://www.investopedia.com/terms/c/central_limit_theorem.asp">Investopedia:
What Is the Central Limit Theorem(CLT)?</a> (Accessed on 2021-05-15)</p>
</blockquote>
<p>Granted, the <a
href="https://www.investopedia.com/terms/s/sampling-distribution.asp">distribution
of sample</a> link sends you to the sampling distribution page. For
those unfamiliar, a sampling distribution is a distribution of a
<strong>statistic</strong>. I'll go into detail about this concept later
in the post. Had <em>Investopedia</em> used the term "sampling
distribution" or "distribution of sample means", I wouldn't have picked
on them. However, "distribution of sample" is confusing and readers can
erroneously conclude that the dsitribution of the sample itself
approaches a noraml distribution.</p>
<h1 id="sampling-distribution">Sampling distribution</h1>
<p>Sampling distribution is one of those concepts in statistics that
confuses a lot of people. In a nutshell, a sampling distribution is the
distribution of a statisic calculated from a sample. For example, the
distribution of the sample mean is a sampling distribution. Notice that
this is different from the distribution of the sample itself. Using some
R code, I'm going to generate a random sample from a Gamma distribution
with shape 1 and scale 10. I chose this distribution because it is very
skewed, which makes it easy to see the difference.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20210517</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot theoretical distribution and compare to distribution of sample for n=100</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>dat_comp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>, <span class="at">by=</span><span class="fl">0.01</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">theoretical =</span> <span class="fu">dgamma</span>(x, <span class="at">shape=</span><span class="dv">1</span>, <span class="at">scale=</span><span class="dv">10</span>), <span class="at">sample =</span> <span class="fu">rgamma</span>(<span class="fu">n</span>(), <span class="at">shape=</span><span class="dv">1</span>, <span class="at">scale=</span><span class="dv">10</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_comp, <span class="fu">aes</span>(<span class="at">x=</span>sample)) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">binwidth=</span><span class="dv">5</span>) <span class="sc">+</span> <span class="co">#use density instead of count</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>theoretical), <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Theoretical vs Sample&quot;</span>, <span class="at">x=</span><span class="st">&quot;Value&quot;</span>, <span class="at">y=</span><span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">40</span>)</span></code></pre></div>
<p><img src="figures/clt-theoretical-vs-sample.png"
title="Sampled distribution follows theoretical Gamma distribution shape"
style="margin:auto; display: block;"
alt="clt-theoretical-vs-sample" /></p>
<p>The red line is the theoretical gamma density with shape 1 and scale
10 and the histogram shows the distribution of the sample generated from
the theoretical distribution. As you can see, the two are similar in
shape. This should make intuitive sense. The CLT states that when
certain conditions are met, the sampling distribution approaches a
Normal distribution. For sample means, the data (or sample) must meet
the following criteria for the CLT to hold.</p>
<ol type="1">
<li>Observations must be random and independent from one another.</li>
<li>The population from which the sample is taken must have a Normal
distribution <em>or</em> the sample size must be <em>sufficiently
large</em> (typically 30).</li>
<li>The population must be at least 10 times greater than the sample
size.</li>
</ol>
<p>The CLT for sample proportions is similar, but the second condition
changes to requiring at least 10 successes and 10 failures. Let’s see
how the shape of the sampling distribution changes as we increase the
sample size from 5 to 100. We’re using the same Gamma distribution from
before and we generate 10,000 random samples for each sample size and
calculate their sample means. The plot below show the distribution of
the sample means.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling distribution for different sample sizes</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>numsim <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># number of simulations for generating sampling distribution</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize output matrix</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nr=</span>numsim, <span class="at">nc=</span><span class="fu">length</span>(N))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;5&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;25&quot;</span>, <span class="st">&quot;50&quot;</span>, <span class="st">&quot;100&quot;</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(output) <span class="ot">&lt;-</span> col_names</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random gamma random variables with shape=1, scale=10</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numsim){</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(N)){</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> N[j]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    output[i, j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rgamma</span>(n, <span class="at">shape=</span><span class="dv">1</span>, <span class="at">scale=</span><span class="dv">10</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Organize results for easy plotting</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>dat_sampling <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(output) <span class="sc">%&gt;%</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>col_names, <span class="at">names_to=</span><span class="st">&quot;n&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n=</span><span class="fu">factor</span>(n))</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>dat_sampling<span class="sc">$</span>n <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_sampling<span class="sc">$</span>n, <span class="at">levels=</span>col_names) <span class="co">#reorder levels to be increasing</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sampling distribution</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_sampling, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">color=</span>n)) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Sampling Distribution&quot;</span>, <span class="at">x=</span><span class="st">&quot;Sample Mean&quot;</span>, <span class="at">y=</span><span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">40</span>)</span></code></pre></div>
<p><img src="figures/clt-sampling-distribution.png"
title="Increasing the sample size makes the sampling distribution approach a Normal distribution"
style="margin:auto; display: block;"
alt="clt-sampling-distribution" /></p>
<p>It’s not difficult to notice that the shape of the sampling
distribution is becoming more and more bell-shaped as the sample size
increases. Even though the original Gamma distribution is severely
skewed, the sampling distribution of the sample mean is close to a
Normal distribution when the sample size is 25. <strong>However, there
is nothing magical about 25</strong>. If the original distribution is
close to Normal, you can get away with a smaller sample. On the other
hand, if you have an extremely skewed distribution like this example,
even a sample size of 25 may not be sufficient to claim that the
sampling distribution is approximately Normal. Furthermore, you can also
see that the mean of the sampling distribution is approaching 10 as
sample size increases. In fact, 10 is the theoretical mean of a Gamma
distribution with shape 1 and scale 10.</p>
<h1 id="importance-of-clt">Importance of CLT</h1>
<p>The true power of CLT comes from our ability to make statistical
inference on the parameter from the single sample we have. Consider the
following scenario. You’re a statistician tasked to calculate the
approval rating for the current U.S. president. The most obvious way of
calculating the approval rating is to ask everyone and see how many
people approve of the president out of the total number of people you
asked. I hope I don’t have to convince you that this approach is absurd.
It would take months or even years to ask everyone, people might change
their minds while you’re still collecting data, and it would cost you a
fortune to conduct this survey. A much more reasonable approach is to
get a representative sample of the U.S. population (though this is much
easier said than done) and try to infer what the rest of the country is
thinking based on the approval rating from the sample. This is what
statisticians call <em>statistical inference</em>.</p>
<p>If the sample you collected meets all the criteria for the CLT to
hold, then you know that the sampling distribution is approximately
Normal. Because the Normal distribution is well-understood,
statisticians can create confidence intervals and perform hypothesis
tests about the population parameter (the population approval rating of
the U.S. president, in this case). This works even though they don’t
know what the true value of the population parameter is and only have a
single sample instead of the 10,000 samples I generated in my previous
example.</p>
        </div>
      </div>
      <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>
    </div>

    <div id="mySidenav">
      <a href="/index.html" id="home">Home</a>
      <a href="/posts/index.html" id="blog">Blog</a>
      <a href="/resume.pdf" id="resume">Resume</a>
      <a href="/pets.html" id="pets">Pets</a>
    </div>

    <footer class="page-footer">
      <div class="container">
        This work is marked
        <a href="https://creativecommons.org/publicdomain/zero/1.0/"
          >CC0 1.0 Universal</a
        ><img
          src="https://mirrors.creativecommons.org/presskit/icons/cc.svg"
          alt=""
          style="max-width: 1em; max-height: 1em; margin-left: 0.2em"
        /><img
          src="https://mirrors.creativecommons.org/presskit/icons/zero.svg"
          alt=""
          style="max-width: 1em; max-height: 1em; margin-left: 0.2em"
        />
    </footer>
  </body>
</html>
